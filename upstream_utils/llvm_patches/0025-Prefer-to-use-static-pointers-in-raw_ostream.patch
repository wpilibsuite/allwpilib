From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: PJ Reiniger <pj.reiniger@gmail.com>
Date: Thu, 19 May 2022 00:58:36 -0400
Subject: [PATCH 25/37] Prefer to use static pointers in raw_ostream

See #1401
---
 llvm/lib/Support/raw_ostream.cpp | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/llvm/lib/Support/raw_ostream.cpp b/llvm/lib/Support/raw_ostream.cpp
index 3c87f82ec069d4f0f8552ab9ed891248d4368523..c80f95911259a8f4332ae20582a89fc8bd5b013a 100644
--- a/llvm/lib/Support/raw_ostream.cpp
+++ b/llvm/lib/Support/raw_ostream.cpp
@@ -616,9 +616,9 @@ raw_fd_ostream &llvm::outs() {
   EC = enablezOSAutoConversion(STDOUT_FILENO);
   assert(!EC);
 #endif
-  static raw_fd_ostream S("-", EC, sys::fs::OF_None);
+  static raw_fd_ostream* S = new raw_fd_ostream("-", EC, sys::fs::OF_None);
   assert(!EC);
-  return S;
+  return *S;
 }
 
 raw_fd_ostream &llvm::errs() {
@@ -627,8 +627,8 @@ raw_fd_ostream &llvm::errs() {
   std::error_code EC = enablezOSAutoConversion(STDERR_FILENO);
   assert(!EC);
 #endif
-  static raw_fd_ostream S(STDERR_FILENO, false, true);
-  return S;
+  static raw_fd_ostream* S = new raw_fd_ostream(STDERR_FILENO, false, true);
+  return *S;
 }
 
 /// nulls() - This returns a reference to a raw_ostream which discards output.
