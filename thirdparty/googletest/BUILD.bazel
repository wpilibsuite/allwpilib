load("//shared/bazel/rules:cc_rules.bzl", "wpilib_cc_library", "wpilib_cc_static_library")
load("//shared/bazel/rules:packaging.bzl", "package_static_cc_project")

wpilib_cc_library(
    name = "googletest",
    srcs = glob([
        "src/**/*.cc",
        "src/**/*.cpp",
        "src/**/*.h",
        "src/**/*.hpp",
    ], allow_empty = True),
    hdrs = glob([
        "include/**/*.h",
        "include/**/*.hpp",
    ], allow_empty = True),
    hdrs_pkg_root = "include",
    include_license_files = True,
    includes = ["src/googletest"],
    srcs_pkg_root = "src",
    strip_include_prefix = "include",
    visibility = ["//visibility:public"],
)

wpilib_cc_static_library(
    name = "static/googletest",
    static_lib_name = select({
        "@platforms//os:windows": "static/googletest.lib",
        "//conditions:default": "static/libgoogletest.a",
    }),
    visibility = ["//visibility:public"],
    deps = [
        ":googletest",
    ],
)

package_static_cc_project(
    name = "googletest",
    maven_artifact_name = "googletest-cpp",
    maven_group_id = "edu.wpi.first.thirdparty.googletest",
)
